
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API v1 (deprecated) &mdash; CoCalc Manual  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="canonical" href="https://doc.cocalc.com/api/index.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cocalc.com/analytics.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="add_collaborator" href="add_collaborator.html" />
    <link rel="prev" title="purchasing licenses" href="../api2/purchasing-licenses.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
    <link rel="canonical" href="https://doc.cocalc.com/api/index.html"/>
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../index.html" class="icon icon-home"> CoCalc Manual
  <img src="../_static/../_static/cocalc-doc-logo.svg" class="logo" alt="Logo"/>
</a>

<style>
div.cocalc-header {
  padding: 10px;
  margin-bottom: 10px;
  color: white;
  background-color: #4375c1;
  font-weight: bold;
  text-align: center;
  box-shadow: 1px 4px 4px -1px #4375c1;
  border-radius: 0 0 3px 3px;
}
div.cocalc-header a {
  color: #ddd;
  background-color: transparent;
  text-decoration: none;
}
</style>

<div class="cocalc-header">
  We provide the best real-time collaborative environment for <a href="https://cocalc.com/features/jupyter-notebook">Jupyter</a>, <a href="https://cocalc.com/features/latex-editor">LaTeX</a>, and <a href="https://cocalc.com/features/jupyter-notebook">SageMath</a>!
</div>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alternativeto/index.html">Alternatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_features.html">Main Features</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../working_with.html">Working With</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../frame-editor.html">Frame Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software.html">Software Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vscode.html">Visual Studio Code Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../R_IDE.html">R IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../x11.html">X11 Graphical Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sagews.html">Sage Worksheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../markdown.html">Markdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rich-text.html">Rich Text Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../csv-viewer.html">CSV Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../whiteboard.html">Whiteboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks.html">Task Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timers.html">Stopwatches and Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slides.html">Slides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snippets.html">Snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apikeys.html">API Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api2/index.html">API v2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">API v1 (deprecated)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deprecation-notice">Deprecation Notice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protocol-and-data-format">Protocol and Data Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-references">Additional References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-message-reference">API Message Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="add_collaborator.html">add_collaborator</a></li>
<li class="toctree-l4"><a class="reference internal" href="add_license_to_project.html">add_license_to_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="change_email_address.html">change_email_address</a></li>
<li class="toctree-l4"><a class="reference internal" href="change_password.html">change_password</a></li>
<li class="toctree-l4"><a class="reference internal" href="copy_path_between_projects.html">copy_path_between_projects</a></li>
<li class="toctree-l4"><a class="reference internal" href="copy_path_delete.html">copy_path_delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="copy_path_status.html">copy_path_status</a></li>
<li class="toctree-l4"><a class="reference internal" href="copy_public_path_between_projects.html">copy_public_path_between_projects</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_account.html">create_account</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_project.html">create_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_support_ticket.html">create_support_ticket</a></li>
<li class="toctree-l4"><a class="reference internal" href="delete_account.html">delete_account</a></li>
<li class="toctree-l4"><a class="reference internal" href="disconnect_from_project.html">disconnect_from_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="forgot_password.html">forgot_password</a></li>
<li class="toctree-l4"><a class="reference internal" href="get_available_upgrades.html">get_available_upgrades</a></li>
<li class="toctree-l4"><a class="reference internal" href="get_support_tickets.html">get_support_tickets</a></li>
<li class="toctree-l4"><a class="reference internal" href="get_usernames.html">get_usernames</a></li>
<li class="toctree-l4"><a class="reference internal" href="invite_collaborator.html">invite_collaborator</a></li>
<li class="toctree-l4"><a class="reference internal" href="invite_noncloud_collaborators.html">invite_noncloud_collaborators</a></li>
<li class="toctree-l4"><a class="reference internal" href="log_client_error.html">log_client_error</a></li>
<li class="toctree-l4"><a class="reference internal" href="metrics.html">metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="ping.html">ping</a></li>
<li class="toctree-l4"><a class="reference internal" href="project_exec.html">project_exec</a></li>
<li class="toctree-l4"><a class="reference internal" href="public_get_text_file.html">public_get_text_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="query.html">query</a></li>
<li class="toctree-l4"><a class="reference internal" href="read_text_file_from_project.html">read_text_file_from_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="remove_collaborator.html">remove_collaborator</a></li>
<li class="toctree-l4"><a class="reference internal" href="remove_license_from_project.html">remove_license_from_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="reset_forgot_password.html">reset_forgot_password</a></li>
<li class="toctree-l4"><a class="reference internal" href="start_metrics.html">start_metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="touch_project.html">touch_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="unlink_passport.html">unlink_passport</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_auth.html">user_auth</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_search.html">user_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="write_text_file_to_project.html">write_text_file_to_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-examples-howto">API Examples &amp; Howto</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#copy-a-file-between-projects">Copy a file between projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#embedding-in-an-iframe">Embedding in an IFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iframe-communication">IFrame communication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../display-options.html">Display Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_options.html">Service Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">How-tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-instructors.html">Instructor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-students.html">Student Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/trouble.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
  <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
  <a href="../index.html">CoCalc Manual</a>

      </nav>

      <div class="wy-nav-content">

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../working_with.html">Working With</a></li>
      <li class="breadcrumb-item active">API v1 (deprecated)</li>
<li class="wy-breadcrumbs-aside" style="padding: 0;">
  <a
    class="fa fa-question-circle"
    href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!"
    style="background-color: #daeefb; color: black; border: 3px solid #2980b9; padding: 2px 5px; border-radius: 4px;"
  >
    Ask us a Question!
  </a>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-v1-deprecated">
<span id="index-0"></span><h1>API v1 (deprecated)<a class="headerlink" href="#api-v1-deprecated" title="Link to this heading"></a></h1>
<section id="deprecation-notice">
<h2>Deprecation Notice<a class="headerlink" href="#deprecation-notice" title="Link to this heading"></a></h2>
<p><strong>This API has been deprecated and is no longer under active development.</strong> Please use
<a class="reference internal" href="../api2/index.html"><span class="doc">our v2 API</span></a>, which features better documentation, developer support,
and features.</p>
<p>Documentation for the deprecated API can be found below.</p>
</section>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Link to this heading"></a></h2>
<p>The purpose of the CoCalc API (application programming interface) is to make
essential operations within the CoCalc platform available to automated
clients. This allows embedding of CoCalc services within other products
and customizing the external look and feel of the application.</p>
</section>
<section id="protocol-and-data-format">
<h2>Protocol and Data Format<a class="headerlink" href="#protocol-and-data-format" title="Link to this heading"></a></h2>
<p>Each API command is invoked using an HTTPS POST request.
All commands support request parameters in JSON format, with request header
<code class="docutils literal notranslate"><span class="pre">Content-Type:</span> <span class="pre">application/json</span></code>. Many commands (those that do not
require lists or objects as parameters)
also accept request parameters as key-value pairs, i.e.
<code class="docutils literal notranslate"><span class="pre">Content-Type:</span> <span class="pre">application/x-www-form-urlencoded</span></code>.</p>
<p>Responses are formatted as JSON strings.
Note that it is possible for a request to fail and return
a response code of 200. In that case, the response
string may contain helpful information on the nature of
the failure. In other cases, if the request cannot
be completed, a response code other than 200 may be
returned, and the response body may be a
generic HTML message rather than a JSON string.</p>
</section>
<section id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Link to this heading"></a></h2>
<p>A valid API key is required on all API requests. To learn how to create an API key, see <a class="reference internal" href="../apikeys.html"><span class="doc">API Keys</span></a>.</p>
</section>
<section id="additional-references">
<h2>Additional References<a class="headerlink" href="#additional-references" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The <a class="reference external" href="https://share.cocalc.com/share/6eec7a75ce704502e2d557f44c316bf75c5c6ce7/Public/?viewer=share">CoCalc API tutorial</a> illustrates API calls in Python.</p></li>
<li><p>The CoCalc PostgreSQL schema definition <a class="reference external" href="https://github.com/sagemathinc/cocalc/blob/master/src/packages/util/db-schema">src/packages/util/db-schema</a> has information on tables and fields used with the API <code class="docutils literal notranslate"><span class="pre">query</span></code> request.</p></li>
<li><p>The API test suite <a class="reference external" href="https://github.com/sagemathinc/cocalc/tree/master/src/smc-hub/test/api">src/smc-hub/test/api/</a> contains mocha unit tests for the API messages.</p></li>
<li><p>The CoCalc message definition file <a class="reference external" href="https://github.com/sagemathinc/cocalc/blob/master/src/packages/util/message.js">src/packages/util/message.js</a> contains the source for this guide.</p></li>
</ul>
</section>
<section id="api-message-reference">
<h2>API Message Reference<a class="headerlink" href="#api-message-reference" title="Link to this heading"></a></h2>
<p>The remainder of this guide explains the individual API endpoints.
Each API request definition begins with the path of the
URL used to invoke the request,
for example <code class="docutils literal notranslate"><span class="pre">/api/v1/change_email_address</span></code>.
The path name ends with the name of the request,
for example, <code class="docutils literal notranslate"><span class="pre">change_email_address</span></code>.
Following the path is the list of options.
After options are one or more sample invocations
illustrating format of the request as made with the <code class="docutils literal notranslate"><span class="pre">curl</span></code>
command, and the format of the response.</p>
<p>The following two options appear on all API messages
(request parameters are often referred to
as ‘options’ in the guide):</p>
<ul class="simple">
<li><p><strong>event</strong>: the command to be executed, for example “ping”</p></li>
<li><p><strong>id</strong>: uuid for the API call, returned in response in most cases.
If id is not provided in the API message, a random id will be
generated and returned in the response.</p></li>
</ul>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API Endpoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="add_collaborator.html">add_collaborator</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_license_to_project.html">add_license_to_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="change_email_address.html">change_email_address</a></li>
<li class="toctree-l1"><a class="reference internal" href="change_password.html">change_password</a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_path_between_projects.html">copy_path_between_projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_path_delete.html">copy_path_delete</a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_path_status.html">copy_path_status</a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_public_path_between_projects.html">copy_public_path_between_projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_account.html">create_account</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_project.html">create_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_support_ticket.html">create_support_ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete_account.html">delete_account</a></li>
<li class="toctree-l1"><a class="reference internal" href="disconnect_from_project.html">disconnect_from_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="forgot_password.html">forgot_password</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_available_upgrades.html">get_available_upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_support_tickets.html">get_support_tickets</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_usernames.html">get_usernames</a></li>
<li class="toctree-l1"><a class="reference internal" href="invite_collaborator.html">invite_collaborator</a></li>
<li class="toctree-l1"><a class="reference internal" href="invite_noncloud_collaborators.html">invite_noncloud_collaborators</a></li>
<li class="toctree-l1"><a class="reference internal" href="log_client_error.html">log_client_error</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="ping.html">ping</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_exec.html">project_exec</a></li>
<li class="toctree-l1"><a class="reference internal" href="public_get_text_file.html">public_get_text_file</a></li>
<li class="toctree-l1"><a class="reference internal" href="query.html">query</a></li>
<li class="toctree-l1"><a class="reference internal" href="read_text_file_from_project.html">read_text_file_from_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="remove_collaborator.html">remove_collaborator</a></li>
<li class="toctree-l1"><a class="reference internal" href="remove_license_from_project.html">remove_license_from_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="reset_forgot_password.html">reset_forgot_password</a></li>
<li class="toctree-l1"><a class="reference internal" href="start_metrics.html">start_metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="touch_project.html">touch_project</a></li>
<li class="toctree-l1"><a class="reference internal" href="unlink_passport.html">unlink_passport</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_auth.html">user_auth</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_search.html">user_search</a></li>
<li class="toctree-l1"><a class="reference internal" href="write_text_file_to_project.html">write_text_file_to_project</a></li>
</ul>
</div>
<hr class="docutils" />
<section id="api-examples-howto">
<h3>API Examples &amp; Howto<a class="headerlink" href="#api-examples-howto" title="Link to this heading"></a></h3>
</section>
</section>
<section id="copy-a-file-between-projects">
<span id="index-1"></span><h2>Copy a file between projects<a class="headerlink" href="#copy-a-file-between-projects" title="Link to this heading"></a></h2>
<p>First, save your API key in a file <code class="docutils literal notranslate"><span class="pre">api.key</span></code>.
Then, we use the <a class="reference external" href="https://requests.readthedocs.io/en/master/">requests</a> library to issue calls:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;api.key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">r</span>
</pre></div>
</div>
<p>Copy request:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;src_project_id&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;src_path&#39;</span><span class="p">:</span> <span class="s1">&#39;cocalc-api/api-demo.ipynb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;target_project_id&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wait_until_done&#39;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;https://cocalc.com/api/v1/copy_path_between_projects&#39;</span><span class="p">,</span>
             <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
             <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">res</span>
</pre></div>
</div>
<p>response <code class="docutils literal notranslate"><span class="pre">res</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;event&#39;</span><span class="p">:</span> <span class="s1">&#39;copy_path_between_projects_response&#39;</span><span class="p">,</span>
 <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;52818dfe-b580-404e-89e6-9845fac7076c&#39;</span><span class="p">,</span>
 <span class="s1">&#39;copy_path_id&#39;</span><span class="p">:</span> <span class="s1">&#39;65cd2079-098d-4147-bb54-12d44cebb8cb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;note&#39;</span><span class="p">:</span> <span class="s1">&#39;Query copy_path_status with the copy_path_id to learn if the copy operation was successful.&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, we wait a few seconds. Then, we check the status using <code class="docutils literal notranslate"><span class="pre">copy_path_id</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;copy_path_id&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;copy_path_id&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;https://cocalc.com/api/v1/copy_path_status&#39;</span><span class="p">,</span>
             <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
             <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">res</span>
</pre></div>
</div>
<p>which gives</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;event&#39;</span><span class="p">:</span> <span class="s1">&#39;copy_path_status_response&#39;</span><span class="p">,</span>
 <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;abc3ca91-1388-4208-bdeb-540054e5bcaf&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;copy_path_id&#39;</span><span class="p">:</span> <span class="s1">&#39;da3a8eaf-14df-4bf8-9131-13bcb9c7e9e5&#39;</span><span class="p">,</span>
  <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-11-03T16:20:54.222Z&#39;</span><span class="p">,</span>
  <span class="s1">&#39;source_project_id&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
  <span class="s1">&#39;source_path&#39;</span><span class="p">:</span> <span class="s1">&#39;cocalc-api/api-demo.ipynb&#39;</span><span class="p">,</span>
  <span class="s1">&#39;target_project_id&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
  <span class="s1">&#39;target_path&#39;</span><span class="p">:</span> <span class="s1">&#39;cocalc-api/api-demo.ipynb&#39;</span><span class="p">,</span>
  <span class="s1">&#39;overwrite_newer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
  <span class="s1">&#39;delete_missing&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
  <span class="s1">&#39;backup&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
  <span class="s1">&#39;started&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-11-03T16:20:54.234Z&#39;</span><span class="p">,</span>
  <span class="s1">&#39;finished&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-11-03T16:20:55.177Z&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note: <code class="docutils literal notranslate"><span class="pre">started</span></code> and <code class="docutils literal notranslate"><span class="pre">finished</span></code> being part of the response, signals it did work.</p>
</section>
<section id="embedding-in-an-iframe">
<span id="index-2"></span><h2>Embedding in an IFrame<a class="headerlink" href="#embedding-in-an-iframe" title="Link to this heading"></a></h2>
<p>Here are notes on integrating CoCalc in an IFrame in a web application using the CoCalc API.
You should be able to create a proof of concept using the API introduction above and these notes.</p>
<ol class="arabic simple">
<li><p>You need an account with an API key. You can get an API key via the UI or here using the <a class="reference internal" href="create_account.html"><span class="doc">create_account</span></a> API call.</p></li>
<li><p>You can create several accounts. If you are running the CoCalc Docker image, you probably want one account <a class="reference external" href="https://github.com/sagemathinc/cocalc-docker#make-a-user-an-admin">to be an admin</a> and then have additional accounts for each actual user of your platform.</p></li>
<li><p>You have to create at least one project.
Note: <em>The production website runs each project in their own container.</em>
<em>This means you might want to create several projects to get proper isolation.</em></p></li>
<li><p>With the API, you can <a class="reference internal" href="copy_path_between_projects.html"><span class="doc">copy files between projects</span></a> or <a class="reference internal" href="write_text_file_to_project.html"><span class="doc">write to a file</span></a>. It’s also possible to <a class="reference internal" href="project_exec.html"><span class="doc">run arbitrary commands</span></a>.</p></li>
<li><p>To show a notebook to a user (and just the notebook) you need to do this:</p>
<ul class="simple">
<li><p><a class="reference internal" href="user_auth.html"><span class="doc">get a fresh auth token</span></a></p></li>
<li><p>make an IFrame in your website, which points to a project and file, and ends with <code class="docutils literal notranslate"><span class="pre">?auth_token=...&amp;fullscreen=kiosk</span></code>.
The parameter <code class="docutils literal notranslate"><span class="pre">fullscreen=kiosk</span></code> removes the UI.
A full example might look like this
<code class="docutils literal notranslate"><span class="pre">https://cocalc.com/projects/.../files/calculate.ipynb?auth_token=...&amp;fullscreen=kiosk&amp;session=</span></code></p></li>
</ul>
</li>
</ol>
</section>
<section id="iframe-communication">
<h2>IFrame communication<a class="headerlink" href="#iframe-communication" title="Link to this heading"></a></h2>
<p>This is a communication channel to improve working with an embedded CoCalc instance.
It gives the parent page the ability to send command-messages to CoCalc (e.g. opening a specific page, etc.) and receiving responses.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The IFrame communication might be currently broken.
Please check <a class="reference external" href="https://github.com/sagemathinc/cocalc/issues/6059">issue #6059</a> for the current status.</p>
</div>
<p>The underlying technology is <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">window.postMessage</a>.</p>
<p>The parent page must be served using <code class="docutils literal notranslate"><span class="pre">https</span></code>!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is <em>beta</em> and only available for specific domains.
Please contact us if you want to use this.</p>
</div>
<p>To get started, you just have to embed the main <code class="docutils literal notranslate"><span class="pre">/app</span></code> endpoint in an IFrame’s <code class="docutils literal notranslate"><span class="pre">src</span></code> like that:</p>
<blockquote>
<div><p><a class="reference external" href="https://cocalc.com/app?auth_token=......&amp;fullscreen=kiosk&amp;session=">https://cocalc.com/app?auth_token=……&amp;fullscreen=kiosk&amp;session=</a></p>
</div></blockquote>
<p>Once CoCalc is ready, the loading screen shows a green banner of confirmation.</p>
<p><strong>Sending messages</strong> Use <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a> on the <code class="docutils literal notranslate"><span class="pre">contentWindow</span></code> of CoCalc’s IFrame to send messages.
E.g. if your IFrame has the <code class="docutils literal notranslate"><span class="pre">id=&quot;cocalc&quot;</span></code>, run <code class="docutils literal notranslate"><span class="pre">cocalc</span> <span class="pre">=</span> <span class="pre">document.getElementById(&quot;cocalc&quot;).contentWindow;</span></code> and then <code class="docutils literal notranslate"><span class="pre">cocalc.postMessage(payload,</span> <span class="pre">&quot;https://cocalc.com&quot;)</span></code>. <code class="docutils literal notranslate"><span class="pre">payload</span></code> is the message, which is explained below.</p>
<p><strong>Receiving message</strong></p>
<ol class="arabic simple">
<li><p>write a callback function like <code class="docutils literal notranslate"><span class="pre">function</span> <span class="pre">replies(mesg)</span> <span class="pre">{</span> <span class="pre">console.log(mesg.data);</span> <span class="pre">}</span></code>.</p></li>
<li><p>Possibly check if <code class="docutils literal notranslate"><span class="pre">mesg.origin</span></code> is really CoCalc’s domain.</p></li>
<li><p>Hook up this callback via <code class="docutils literal notranslate"><span class="pre">window.addEventListener(&quot;message&quot;,</span> <span class="pre">replies,</span> <span class="pre">false);</span></code>.</p></li>
</ol>
<p><strong>Messages sent to CoCalc</strong> have the following structure. The <code class="docutils literal notranslate"><span class="pre">action</span></code> field is mandatory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="n">action</span><span class="p">:</span> <span class="s2">&quot;[command]&quot;</span><span class="p">,</span>
  <span class="n">field1</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
  <span class="n">field2</span><span class="p">:</span> <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each message has a <strong>response</strong>, usually containing <code class="docutils literal notranslate"><span class="pre">{status:</span> <span class="pre">&quot;ack|done|error&quot;,</span> <span class="pre">...}</span></code>.</p>
<p>In particular, <strong>error responses</strong> have the structure <code class="docutils literal notranslate"><span class="pre">{status:</span> <span class="pre">&quot;error&quot;,</span> <span class="pre">mesg:</span> <span class="pre">&quot;[error</span> <span class="pre">message]&quot;,</span> <span class="pre">...}</span></code>.</p>
<p>Available commands and their responses:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">open</span></code> – open a specific file in a project.</p>
<ul>
<li><p>fields:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">project_id</span></code> – the UUID of the project</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> – the location relative to the home directory. e.g. <code class="docutils literal notranslate"><span class="pre">notebook.ipynb</span></code> or <code class="docutils literal notranslate"><span class="pre">subdir1/file.md</span></code>.</p></li>
</ul>
</li>
<li><p>responses:</p>
<ol class="arabic simple">
<li><p>acknowledgement of command (project will start, file will open): <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">status:</span> <span class="pre">&quot;ack&quot;,</span> <span class="pre">...</span> <span class="pre">}</span></code></p></li>
<li><p>file editor is opened and loading of content starts: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">status:</span> <span class="pre">&quot;done&quot;,</span> <span class="pre">...</span> <span class="pre">}</span></code></p></li>
</ol>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">closeall</span></code> – this closes all open files</p>
<ul>
<li><p>response: <code class="docutils literal notranslate"><span class="pre">{status:</span> <span class="pre">&quot;done&quot;,</span> <span class="pre">mesg:</span> <span class="pre">&quot;all</span> <span class="pre">files</span> <span class="pre">are</span> <span class="pre">closed&quot;}</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> – returns a snapshot of CoCalc’s overall status. In particular during starting CoCalc, querying this for a response is useful to know when CoCalc is available and connected to the front-end servers.</p>
<ul>
<li><p>response:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">connection</span></code> – more detailed information about the connection quality, ping time, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">open_files</span></code> – mapping of <code class="docutils literal notranslate"><span class="pre">project_id</span></code> to a list of paths.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api2/purchasing-licenses.html" class="btn btn-neutral float-left" title="purchasing licenses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="add_collaborator.html" class="btn btn-neutral float-right" title="add_collaborator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sagemath, Inc., CC BY-4.0 licensed.</p>
  </div>

  

<div role="contentinfo">
  <p>
    Please contact us for <a href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!">Questions and Feedback</a>,
    <a href="https://github.com/sagemathinc/cocalc-doc/">Documentation Repository</a>,
    <a href="https://cocalc.com/policies/">Privacy Policy and ToS</a>.
   </p>
   <p>
    <a href="https://github.com/sagemathinc/cocalc-doc/edit/master/source/api/index.rst" class="fa fa-github"> Edit this page on GitHub</a>
  </p>
  <p>
    <strong><a href="https://cocalc.com/app">Start CoCalc</a></strong> – start free, upgrade later!
  </p>
</div>


</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
   
  <a class="github cocalcbanner" href="https://cocalc.com/app?anonymous=true">
     <img alt="Start CoCalc"
          class="github"
          src="../_static/start-cocalc.png"
          style="position: fixed; top: 0; right: 0; border: 0; height: 75px; width: 75px">
  </a>


</body>
</html>
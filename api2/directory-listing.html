
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>directory-listing &mdash; CoCalc Manual  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="canonical" href="https://doc.cocalc.com/api2/directory-listing.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cocalc.com/analytics.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="get-purchases (Python example)" href="get-purchases.html" />
    <link rel="prev" title="API v2" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
    <link rel="canonical" href="https://doc.cocalc.com/api2/directory-listing.html"/>
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../index.html" class="icon icon-home"> CoCalc Manual
  <img src="../_static/../_static/cocalc-doc-logo.svg" class="logo" alt="Logo"/>
</a>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with.html">Working With</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../platform.html">Platform</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../project.html">Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../share.html">Collaborate. Share! Publish!!!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software.html">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backups.html">Backups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time-travel.html">Time Travel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apikeys.html">API Keys</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">API v2</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#api-v2-endpoints">API v2 Endpoints</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">directory-listing</a></li>
<li class="toctree-l4"><a class="reference internal" href="get-purchases.html">get-purchases (Python example)</a></li>
<li class="toctree-l4"><a class="reference internal" href="latex.html">latex</a></li>
<li class="toctree-l4"><a class="reference internal" href="stop.html">stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="user-query.html">user-query</a></li>
<li class="toctree-l4"><a class="reference internal" href="email-address-from-account-id.html">email-address-from-account-id</a></li>
<li class="toctree-l4"><a class="reference internal" href="purchasing-licenses.html">purchasing licenses</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API v1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_options.html">Service Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-instructors.html">Instructor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-students.html">Student Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
  <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
  <a href="../index.html">CoCalc Manual</a>

      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../platform.html">Platform</a></li>
          <li class="breadcrumb-item"><a href="index.html">API v2</a></li>
      <li class="breadcrumb-item active">directory-listing</li>
<li class="wy-breadcrumbs-aside" style="padding: 0;">
  <a
    class="fa fa-question-circle"
    href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!"
    style="background-color: #daeefb; color: black; border: 3px solid #2980b9; padding: 2px 5px; border-radius: 4px;"
  >
    Ask us a Question!
  </a>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="directory-listing">
<h1>directory-listing<a class="headerlink" href="#directory-listing" title="Link to this heading"></a></h1>
<section id="using-the-cocalc-api-to-get-directory-listings-for-a-project-via-the-database">
<h2>Using the CoCalc API to get directory listings for a project via the database<a class="headerlink" href="#using-the-cocalc-api-to-get-directory-listings-for-a-project-via-the-database" title="Link to this heading"></a></h2>
<p>We assume you can do a basic query as explained in
<a class="reference external" href="./purchasing-licenses.md">purchasing-licenses.md</a>.</p>
<p>As you browse directories and work with files, CoCalc computes (and
regularly updates) the directory listings for those files. It stores the
listings in the central PostgreSQL database. These listings are
available to very quickly query <strong>even if the project is not running</strong>.
Moreover, as explained below, you can also do a single query to get
listings for all paths that users have explicitly browsed, which is more
efficient than tedious walking the directory tree.</p>
<p><strong>Caveat:</strong> the directory listings you get via the database reflect the
state of the project when a user last expressed interest in that
directory. If you use, e.g., rsync or an api call to copy a file into a
project, don’t expect the directory listing you get via the method here
to necessarily have that file in it.</p>
<section id="directory-listing-for-a-given-path">
<h3>Directory listing for a given path<a class="headerlink" href="#directory-listing-for-a-given-path" title="Link to this heading"></a></h3>
<p>Here we show you how to get the directory listing for <code class="docutils literal notranslate"><span class="pre">path</span></code> in
<code class="docutils literal notranslate"><span class="pre">project_id</span></code> via a user_query to the database. Obviously, the
project_id and path you give below may be different. The path should be
relatively to the HOME directory, e.g., “path”:“” is the HOME directory:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sk<span class="w"> </span>-u<span class="w"> </span><span class="nv">$key</span>:<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;query&quot;:{&quot;listings&quot;:{&quot;project_id&quot;:&quot;5ee8d3ca-b723-4fe5-a94e-dc8c62659886&quot;,&quot;path&quot;:&quot;&quot;,&quot;listing&quot;:null}}}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">$url</span>/user-query<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
</pre></div>
</div>
<p>The above will output something like the following, but with your
account_id and email_address replacing the ones below</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;query&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;listings&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;project_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;5ee8d3ca-b723-4fe5-a94e-dc8c62659886&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;path&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;listing&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;.ssh&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;size&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;isdir&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;mtime&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1677111163.888</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2022-04-04-164144.ipynb&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;size&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1809</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;mtime&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1650036446.483</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2022-04-16-160712.md&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;size&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;mtime&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1650150434.384</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="directory-listings-for-all-known-paths-at-once">
<h3>Directory listings for all known paths at once<a class="headerlink" href="#directory-listings-for-all-known-paths-at-once" title="Link to this heading"></a></h3>
<p>The following shows how to get <strong>all known directory listings for all
paths</strong> in a project. This gives up to 25 distinct paths.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sk<span class="w"> </span>-u<span class="w"> </span><span class="nv">$key</span>:<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;query&quot;:{&quot;listings&quot;:[{&quot;project_id&quot;:&quot;5ee8d3ca-b723-4fe5-a94e-dc8c62659886&quot;,&quot;path&quot;:null,&quot;listing&quot;:null}]}}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">$url</span>/user-query<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="API v2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="get-purchases.html" class="btn btn-neutral float-right" title="get-purchases (Python example)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sagemath, Inc., CC BY-4.0 licensed.</p>
  </div>

  

<div role="contentinfo">
  <p>
    Please contact us for <a href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!">Questions and Feedback</a>,
    <a href="https://github.com/sagemathinc/cocalc-doc/">Documentation Repository</a>,
    <a href="https://cocalc.com/policies/">Privacy Policy and ToS</a>.
   </p>
   <p>
    <a href="https://github.com/sagemathinc/cocalc-doc/edit/master/source/api2/directory-listing.rst" class="fa fa-github"> Edit this page on GitHub</a>
  </p>
  <p>
    <strong><a href="https://cocalc.com/app">Start CoCalc</a></strong> – start free, upgrade later!
  </p>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
   
  <a class="github cocalcbanner" href="https://cocalc.com/app?anonymous=true">
     <img alt="Start CoCalc"
          class="github"
          src="../_static/start-cocalc.png"
          style="position: fixed; top: 0; right: 0; border: 0; height: 75px; width: 75px">
  </a>


</body>
</html>
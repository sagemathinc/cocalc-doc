
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Jupyter Kernel &mdash; CoCalc Manual  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="canonical" href="https://doc.cocalc.com/howto/custom-jupyter-kernel.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cocalc.com/analytics.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fix broken Jupyter PDF export" href="fix-broken-jupyter-pdf.html" />
    <link rel="prev" title="Utilize Multiple CPUs" href="parallel.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
    <link rel="canonical" href="https://doc.cocalc.com/howto/custom-jupyter-kernel.html"/>
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../index.html" class="icon icon-home"> CoCalc Manual
  <img src="../_static/../_static/cocalc-doc-logo.svg" class="logo" alt="Logo"/>
</a>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with.html">Working With</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform.html">Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_options.html">Service Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">How-tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-instructors.html">Instructor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-students.html">Student Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="trouble.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
  <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
  <a href="../index.html">CoCalc Manual</a>

      </nav>

      <div class="wy-nav-content">
<style>
div.rst-content {
  padding-top: 30px;
}
div.cocalc-header {
  padding: 10px;
  margin-bottom: 10px;
  color: white;
  background-color: #4375c1;
  font-weight: bold;
  text-align: center;
  position: fixed;
  top: 0;
  box-shadow: 1px 4px 4px -1px #4375c1;
  border-radius: 0 0 3px 3px;
  width: 90%;
  max-width: 700px;
  word-wrap: break-word;
}
div.cocalc-header a {
  color: #ddd;
  background-color: transparent;
  text-decoration: none;
}
</style>
 <div class="cocalc-header">
   <a href="https://cocalc.com/">CoCalc</a> Runs Your <a href="https://cocalc.com/features/jupyter-notebook">Jupyter Notebooks</a> and <a href="https://cocalc.com/features/terminal">Linux Terminals</a> Using <a href="https://cocalc.com/features/compute-server">Powerful CPUs and GPUs</a>!
</div>

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">How-tos</a></li>
      <li class="breadcrumb-item active">Custom Jupyter Kernel</li>
<li class="wy-breadcrumbs-aside" style="padding: 0;">
  <a
    class="fa fa-question-circle"
    href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!"
    style="background-color: #daeefb; color: black; border: 3px solid #2980b9; padding: 2px 5px; border-radius: 4px;"
  >
    Ask us a Question!
  </a>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="custom-jupyter-kernel">
<span id="jupyter-custom-kernel"></span><span id="index-0"></span><h1>Custom Jupyter Kernel<a class="headerlink" href="#custom-jupyter-kernel" title="Link to this heading"></a></h1>
<p>This short howto explains how you can create and access your own custom Jupyter Kernel inside a CoCalc.
In case you require a specific software package, there are related guides: <a class="reference internal" href="install-python-lib.html"><span class="doc">Install Python Packages</span></a> and  <a class="reference internal" href="install-r-package.html"><span class="doc">Install R Packages</span></a>.</p>
<section id="adding-a-kernel-to-cocalc-jupyter">
<h2>Adding a Kernel to CoCalc Jupyter<a class="headerlink" href="#adding-a-kernel-to-cocalc-jupyter" title="Link to this heading"></a></h2>
<p>Suppose you have a kernel from another source and you would like to add it to the list of Jupyter kernels that can be selected from CoCalc Jupyter. You will need to know the command line arguments needed to start the kernel. Then follow the steps here.</p>
<p>For your convenience, there is a link to these instructions at the bottom of both the <a class="reference internal" href="jupyter-kernel-selection.html#jupyter-kernel-menu"><span class="std std-ref">kernel selection menu</span></a> and the <a class="reference internal" href="jupyter-kernel-selection.html#jupyter-change-kernel-lg"><span class="std std-ref">kernel selection dialog</span></a>.</p>
<p>To accomplish this, we’re working in a <a class="reference internal" href="../terminal.html"><span class="doc">Linux Terminal</span></a>.
If you do not already have one, you can create a terminal in Files, as a “Terminal” file with the extension <code class="docutils literal notranslate"><span class="pre">*.term</span></code>.</p>
<ol class="arabic">
<li><p>Get a list of the currently installed kernels as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/usr/local/share$ jupyter kernelspec list
Available kernels:
  bash              /ext/jupyter/kernels/bash
  ir                /ext/jupyter/kernels/ir
  julia             /ext/jupyter/kernels/julia
  octave            /ext/jupyter/kernels/octave
  python2           /ext/jupyter/kernels/python2
  python3           /ext/jupyter/kernels/python3
  sagemath          /ext/jupyter/kernels/sagemath
  [...]
</pre></div>
</div>
</li>
<li><p>Copy one of the above over that is closest to the kernel you want to create into your project’s <code class="docutils literal notranslate"><span class="pre">~/.local/share/jupyter/kernels/&lt;kernel_name&gt;</span></code> directory, e.g.,</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mkdir -p $HOME/.local/share/jupyter/kernels
cp -arv /ext/jupyter/kernels/sagemath $HOME/.local/share/jupyter/kernels/sage_custom
</pre></div>
</div>
<ol class="arabic" start="3">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">kernel.json</span></code> file copy of the kernel you made:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd $HOME/.local/share/jupyter/kernels/sage_custom
open kernel.json
</pre></div>
</div>
</li>
</ol>
<p>Make sure to change the name of the kernel, etc.  E.g., you might change <code class="docutils literal notranslate"><span class="pre">kernel.json</span></code> to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
 &quot;display_name&quot;: &quot;sage_custom&quot;,
 &quot;argv&quot;: [
     &quot;/home/user/sage/sage&quot;,
     &quot;--python&quot;,
     &quot;-m&quot;,
     &quot;sage.repl.ipython_kernel&quot;,
     &quot;--matplotlib=inline&quot;,
     &quot;-f&quot;,
     &quot;{connection_file}&quot;
 ]
}
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">/home/user/sage/sage</span></code> points to your own Sage installation.
Note, <code class="docutils literal notranslate"><span class="pre">$HOME</span></code> should expand to <code class="docutils literal notranslate"><span class="pre">/home/user</span></code>, which you can check by running <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$HOME</span></code>.</p>
<ol class="arabic" start="4">
<li><p>Now, run <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">kernelspec</span> <span class="pre">list</span></code> again to check that your kernel shows up in the list of all kernels.</p></li>
<li><p>Test your kernel in the terminal first to more easily see what is wrong (if anything):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>jupyter console --kernel=sage_custom
</pre></div>
</div>
</li>
</ol>
<p>An interactive IPython console should start up and you should be able to run Sage commands.</p>
<ol class="arabic simple" start="6">
<li><p>Once you have your kernel working in a terminal, test your kernel from a <a class="reference internal" href="../jupyter.html"><span class="doc">Jupyter Notebook</span></a>. To load an updated list of kernels, scroll down in the “Kernel” menu and select “Refresh kernel list”. Your kernel should show up with the given <code class="docutils literal notranslate"><span class="pre">display_name</span></code>!</p></li>
</ol>
</section>
<section id="creating-a-new-kernel-for-a-custom-python-version">
<h2>Creating a new kernel for a Custom Python Version<a class="headerlink" href="#creating-a-new-kernel-for-a-custom-python-version" title="Link to this heading"></a></h2>
<p>These instructions are for the special case in which you want to create a Jupyter kernel for a version of Python that is not already in CoCalc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following approach may not succeed with a pre-release version of Python.</p>
</div>
<p>The example below uses Python version 3.10.0. This version may already be available in CoCalc when you are reading these instructions. Substitute the actual version of Python you want added to the list of available CoCalc Jupyter kernels.</p>
<ol class="arabic">
<li><p>Get pyenv running <a class="reference external" href="https://github.com/pyenv/pyenv/blob/master/README.md#basic-github-checkout">More details</a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>curl https://pyenv.run | bash
</pre></div>
</div>
</li>
</ol>
<p>Add this to the bottom of your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> or <code class="docutils literal notranslate"><span class="pre">~/.bash_aliases</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export PATH=&quot;$HOME/.pyenv/bin:$PATH&quot;
eval &quot;$(pyenv init --path)&quot;
eval &quot;$(pyenv virtualenv-init -)&quot;
eval &quot;$(pyenv init -)&quot;
</pre></div>
</div>
<p>Restart the terminal via Ctrl-d. “pyenv versions” should then show you what you can install.</p>
<ol class="arabic" start="2">
<li><p>Install the desired version of Python:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pyenv install 3.10.0
pyenv virtualenv 3.10.0 py3.10
pyenv virtualenvs # should include py3.10
</pre></div>
</div>
</li>
<li><p>Start the new virtual environment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pyenv activate py3.10
python -V # displays 3.10.0
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You won’t have access to CoCalc’s more than 1,000 pre-installed Python packages from the virtual environment. You’ll need to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> such packages as pandas and matplotlib. The <code class="docutils literal notranslate"><span class="pre">--user</span></code> flag is not needed with <code class="docutils literal notranslate"><span class="pre">pip</span></code> in the virtual environment.</p>
</div>
<ol class="arabic" start="4">
<li><p>Install ipykernel for Jupyter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install ipykernel
python -m ipykernel install --user --name=py3.10 --display-name &quot;Python 3.10&quot;
</pre></div>
</div>
</li>
</ol>
<p>After the above steps, when you open a Jupyter notebook, you may have to do “Refresh kernel list” at the bottom of the Kernel menu, or refresh the CoCalc tab. You will then see “Python 3.10” listed among the available kernels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a Python kernel, we suggest to add these parameters to the <code class="docutils literal notranslate"><span class="pre">argv</span></code> array:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;--HistoryManager.enabled=False&quot;</span></code>: there is no need to record the history in a local database</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;--matplotlib=inline&quot;</span></code>: to automatically load matplotlib</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parallel.html" class="btn btn-neutral float-left" title="Utilize Multiple CPUs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fix-broken-jupyter-pdf.html" class="btn btn-neutral float-right" title="Fix broken Jupyter PDF export" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sagemath, Inc., CC BY-4.0 licensed.</p>
  </div>

  

<div role="contentinfo">
  <p>
    Please contact us for <a href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!">Questions and Feedback</a>,
    <a href="https://github.com/sagemathinc/cocalc-doc/">Documentation Repository</a>,
    <a href="https://cocalc.com/policies/">Privacy Policy and ToS</a>.
   </p>
   <p>
    <a href="https://github.com/sagemathinc/cocalc-doc/edit/master/source/howto/custom-jupyter-kernel.rst" class="fa fa-github"> Edit this page on GitHub</a>
  </p>
  <p>
    <strong><a href="https://cocalc.com/app">Start CoCalc</a></strong> – start free, upgrade later!
  </p>
</div>


</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
   
  <a class="github cocalcbanner" href="https://cocalc.com/app?anonymous=true">
     <img alt="Start CoCalc"
          class="github"
          src="../_static/start-cocalc.png"
          style="position: fixed; top: 0; right: 0; border: 0; height: 75px; width: 75px">
  </a>


</body>
</html>
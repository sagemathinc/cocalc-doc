
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Google Sheets API Demo &mdash; CoCalc Manual  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="canonical" href="https://doc.cocalc.com/howto/google-api.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cocalc.com/analytics.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NEURON simulation environment" href="neuron.html" />
    <link rel="prev" title="Git Version Control" href="git.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
    <link rel="canonical" href="https://doc.cocalc.com/howto/google-api.html"/>
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../index.html" class="icon icon-home"> CoCalc Manual
  <img src="../_static/../_static/cocalc-doc-logo.svg" class="logo" alt="Logo"/>
</a>

<style>
div.cocalc-header {
  padding: 10px;
  margin-bottom: 10px;
  color: white;
  background-color: #4375c1;
  font-weight: bold;
  text-align: center;
  box-shadow: 1px 4px 4px -1px #4375c1;
  border-radius: 0 0 3px 3px;
}
div.cocalc-header a {
  color: #ddd;
  background-color: transparent;
  text-decoration: none;
}
</style>

<div class="cocalc-header">
  We provide the best real-time collaborative environment for <a href="https://cocalc.com/features/jupyter-notebook">Jupyter</a>, <a href="https://cocalc.com/features/latex-editor">LaTeX</a>, and <a href="https://cocalc.com/features/jupyter-notebook">SageMath</a>!
</div>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alternativeto/index.html">Alternatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with.html">Working With</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform.html">Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_options.html">Service Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">How-tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-instructors.html">Instructor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching-students.html">Student Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="trouble.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
  <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
  <a href="../index.html">CoCalc Manual</a>

      </nav>

      <div class="wy-nav-content">

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">How-tos</a></li>
      <li class="breadcrumb-item active">Google Sheets API Demo</li>
<li class="wy-breadcrumbs-aside" style="padding: 0;">
  <a
    class="fa fa-question-circle"
    href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!"
    style="background-color: #daeefb; color: black; border: 3px solid #2980b9; padding: 2px 5px; border-radius: 4px;"
  >
    Ask us a Question!
  </a>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="google-sheets-api-demo">
<h1>Google Sheets API Demo<a class="headerlink" href="#google-sheets-api-demo" title="Link to this heading"></a></h1>
<p>This example illustrates:</p>
<ul class="simple">
<li><p>writing Python code with frame editor and terminal in <a class="reference internal" href="../terminal.html#terminal-editor-panel"><span class="std std-ref">split view</span></a></p></li>
<li><p>run-through of Google Sheets API <a class="reference external" href="https://developers.google.com/sheets/api/quickstart/python">Python Quickstart</a></p></li>
<li><p><a class="reference external" href="https://developers.google.com/identity/protocols/OAuth2">OAuth2 authentication</a> from a CoCalc project</p></li>
</ul>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#what-the-program-does" id="id1">What the program does</a></p></li>
<li><p><a class="reference internal" href="#get-credentials-file" id="id2">Get credentials file</a></p></li>
<li><p><a class="reference internal" href="#upload-python-script-and-credentials-to-cocalc" id="id3">Upload Python script and credentials to CoCalc</a></p></li>
<li><p><a class="reference internal" href="#first-run-oauth2-authentication" id="id4">First run: OAuth2 authentication</a></p></li>
<li><p><a class="reference internal" href="#second-and-later-runs" id="id5">Second and later runs</a></p></li>
<li><p><a class="reference internal" href="#python-2-compatibility" id="id6">Python 2 compatibility</a></p></li>
<li><p><a class="reference internal" href="#for-further-study" id="id7">For further study</a></p></li>
</ul>
</nav>
<section id="what-the-program-does">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">What the program does</a><a class="headerlink" href="#what-the-program-does" title="Link to this heading"></a></h2>
<p>This example runs a short program to read two columns, “Student Name” and “Major”, from a spreadsheet in Google Sheets and writes them to the user’s terminal.</p>
<p>You don’t need to open the sample data in Google Sheets to run the program, but if you’re curious, you can view it at <a class="reference external" href="https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit#gid=0">Example Spreadsheet</a>.</p>
<a class="reference internal image-reference" href="../_images/example-spreadsheet.png"><img alt="example spreadsheet" src="../_images/example-spreadsheet.png" style="width: 60%;" /></a>
<p>The python program is provided by Google and runs under Python 2 and Python 3.</p>
</section>
<section id="get-credentials-file">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Get credentials file</a><a class="headerlink" href="#get-credentials-file" title="Link to this heading"></a></h2>
<p>To get started, you will need a Google account. You will have one already if you use Gmail or Google Drive. If not, browse to <a class="reference external" href="https://drive.google.com/">drive.google.com</a> and follow the steps to create an account.</p>
<p>Now that you have a Google account, browse to the <a class="reference external" href="https://developers.google.com/sheets/api/quickstart/python">Python Quickstart</a> page at Google and click <code class="docutils literal notranslate"><span class="pre">ENABLE</span> <span class="pre">THE</span> <span class="pre">GOOGLE</span> <span class="pre">SHEETS</span> <span class="pre">API</span></code>:</p>
<a class="reference internal image-reference" href="../_images/enable-sheets-api.png"><img alt="enable sheets api" src="../_images/enable-sheets-api.png" style="width: 50%;" /></a>
<p>In the pop-up dialog, select <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">Create</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">project</span></code>:</p>
<a class="reference internal image-reference" href="../_images/create-project.png"><img alt="create project" src="../_images/create-project.png" style="width: 50%;" /></a>
<p>Give the project a name:</p>
<a class="reference internal image-reference" href="../_images/project-name.png"><img alt="name project" src="../_images/project-name.png" style="width: 50%;" /></a>
<p>Click <code class="docutils literal notranslate"><span class="pre">DOWNLOAD</span> <span class="pre">CLIENT</span> <span class="pre">CONFIGURATION</span></code> to copy file <cite>credentials.json</cite> to your computer.</p>
<a class="reference internal image-reference" href="../_images/download-config.png"><img alt="download config" src="../_images/download-config.png" style="width: 50%;" /></a>
</section>
<section id="upload-python-script-and-credentials-to-cocalc">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Upload Python script and credentials to CoCalc</a><a class="headerlink" href="#upload-python-script-and-credentials-to-cocalc" title="Link to this heading"></a></h2>
<p>Log into your CoCalc account. Make a new folder called <cite>Sheets API</cite> or such.</p>
<p>You can create a folder by typing its name in the Files search box, appending a slash, and pressing Enter:</p>
<a class="reference internal image-reference" href="../_images/create-folder.png"><img alt="create folder" src="../_images/create-folder.png" style="width: 50%;" /></a>
<p>Click <code class="docutils literal notranslate"><span class="pre">(+)</span> <span class="pre">New</span></code> (upper left) or <code class="docutils literal notranslate"><span class="pre">Upload</span></code> (upper right) to upload the <cite>credentials.json</cite> file from your computer into the new folder.</p>
<p>Also upload python source from the GitHub repository for the Google sample program to the same CoCalc folder. The quickstart page has a link to the repo. We want the raw
link to file quickstart.py:
<a class="reference external" href="https://raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py">https://raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py</a></p>
<p>Paste the above link into the <code class="docutils literal notranslate"><span class="pre">(+)</span> <span class="pre">New</span></code> dialog in the CoCalc Files screen:</p>
<a class="reference internal image-reference" href="../_images/upload-py.png"><img alt="upload script" src="../_images/upload-py.png" style="width: 50%;" /></a>
<p>Open the .py file.
Split the view vertically.
Note that the two panes can be scrolled separately.</p>
<a class="reference internal image-reference" href="../_images/split-py.png"><img alt="split the view" src="../_images/split-py.png" style="width: 70%;" /></a>
<p>Change the second pane to a command line terminal and do <code class="docutils literal notranslate"><span class="pre">ls</span></code> to list files in the folder:</p>
<a class="reference internal image-reference" href="../_images/split-ls.png"><img alt="ls comment in the terminal pane" src="../_images/split-ls.png" style="width: 70%;" /></a>
</section>
<section id="first-run-oauth2-authentication">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">First run: OAuth2 authentication</a><a class="headerlink" href="#first-run-oauth2-authentication" title="Link to this heading"></a></h2>
<p>In the terminal file, run the following command. Note the command line option so that OAuth2 does not open a browser inside CoCalc.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">quickstart</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">noauth_local_webserver</span>
</pre></div>
</div>
<p>The program will print a message saying <strong>Go to the following link…</strong>:</p>
<a class="reference internal image-reference" href="../_images/go-to-link.png"><img alt="go to link" src="../_images/go-to-link.png" style="width: 50%;" /></a>
<p>Copy that link from the terminal output. Open a new browser tab and paste it in, and visit that link. If you have more than one Google account, choose the same account you used when creating your <cite>credentials.json</cite> file.
Log into your Google account when you are prompted to do so. You will see a <code class="docutils literal notranslate"><span class="pre">Sign</span> <span class="pre">in</span></code> confirmation message with a code to be copied:</p>
<a class="reference internal image-reference" href="../_images/oauth-sign-in.png"><img alt="sign in" src="../_images/oauth-sign-in.png" style="width: 50%;" /></a>
<p>Click the icon to copy the code to your clipboard. Then paste it into the CoCalc terminal session that is waiting for it and hit Enter.
After a few seconds, you will see the selected columns of sample data:</p>
<a class="reference internal image-reference" href="../_images/verify.png"><img alt="verify" src="../_images/verify.png" style="width: 40%;" /></a>
</section>
<section id="second-and-later-runs">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Second and later runs</a><a class="headerlink" href="#second-and-later-runs" title="Link to this heading"></a></h2>
<p>In the terminal pane, again type <code class="docutils literal notranslate"><span class="pre">ls</span></code> and see that there is now a <cite>token.json</cite> file in your folder. That token saves your authorization. Subsequent runs of the program won’t need the OAuth2 detour through an external browser window. Run the Python script again. This time, you don’t need the added command line switch:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">quickstart</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/second-run.png"><img alt="second run" src="../_images/second-run.png" style="width: 50%;" /></a>
</section>
<section id="python-2-compatibility">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Python 2 compatibility</a><a class="headerlink" href="#python-2-compatibility" title="Link to this heading"></a></h2>
<p>The script provided is compatible with current versions of both Python 2 and Python 3.
The default <code class="docutils literal notranslate"><span class="pre">python</span></code> command in the CoCalc terminal runs Python 3.
Use <code class="docutils literal notranslate"><span class="pre">python2</span></code> at the command line to run quickstart.py with Python 2 compatible versions of the imported modules.</p>
</section>
<section id="for-further-study">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">For further study</a><a class="headerlink" href="#for-further-study" title="Link to this heading"></a></h2>
<p>The Google Sheets API can do much more than download selected columns of a spreadsheet. To learn more, see the documentation
for <a class="reference external" href="https://developers.google.com/sheets/api/">Google Sheets API v4</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="git.html" class="btn btn-neutral float-left" title="Git Version Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="neuron.html" class="btn btn-neutral float-right" title="NEURON simulation environment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sagemath, Inc., CC BY-4.0 licensed.</p>
  </div>

  

<div role="contentinfo">
  <p>
    Please contact us for <a href="https://cocalc.com/support/new?type=question&subject=A%20question%20about%20CoCalc%20...&body=&title=Ask%20us%20a%20Question!">Questions and Feedback</a>,
    <a href="https://github.com/sagemathinc/cocalc-doc/">Documentation Repository</a>,
    <a href="https://cocalc.com/policies/">Privacy Policy and ToS</a>.
   </p>
   <p>
    <a href="https://github.com/sagemathinc/cocalc-doc/edit/master/source/howto/google-api.rst" class="fa fa-github"> Edit this page on GitHub</a>
  </p>
  <p>
    <strong><a href="https://cocalc.com/app">Start CoCalc</a></strong> – start free, upgrade later!
  </p>
</div>


</footer>
        </div>

      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
   
  <a class="github cocalcbanner" href="https://cocalc.com/app?anonymous=true">
     <img alt="Start CoCalc"
          class="github"
          src="../_static/start-cocalc.png"
          style="position: fixed; top: 0; right: 0; border: 0; height: 75px; width: 75px">
  </a>


</body>
</html>